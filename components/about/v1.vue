<template>
  <section id="about" class="about" ref="about">
    <div class="about__title">
      <h1 class="about__title-text">&lt; who am i? /&#62;</h1>
      <div class="about__title-divider"></div>
      <div>
        <img
          class="about__title-icon"
          src="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzg0IDUxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCAzNTJjMCA4OC4zOCA3MS42MyAxNjAgMTYwIDE2MGg2NGM4OC4zOCAwIDE2MC03MS42MyAxNjAtMTYwVjIyNEgwdjEyOHpNMTc2IDBoLTE2QzcxLjYzIDAgMCA3MS42MiAwIDE2MHYzMmgxNzZWMHptNDggMGgtMTZ2MTkyaDE3NnYtMzJDMzg0IDcxLjYyIDMxMi40IDAgMjI0IDB6IiBmaWxsPSIjYWYyN2YyIiBjbGFzcz0iZmlsbC0wMDAwMDAiPjwvcGF0aD48L3N2Zz4="
          alt="Mouse"
          width="14"
          height="18"
          loading="lazy"
          decoding="async"
        />
        <img
          class="about__title-icon about__title-icon--controller"
          src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNy4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA1MDAgNTAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MDAgNTAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7ZmlsbDojQUYyN0YyO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjA5LjcsOTguNWMtMjguOS0yOC4zLTk2LjQtMzkuNy0xMzQuNCwxQzM4LjEsMTM5LjMsOCwyMzUuMSw4LDMyNS40YzAsMTA5LDkxLjQsMTI0LjEsMTQxLjIsNzAuNg0KCWMyOC44LTMxLjEsMzEuNi0zNS45LDUwLjQtNjAuNWgxMDAuOGMxOSwyNC42LDIxLjYsMjkuNCw1MC40LDYwLjVjNDkuOCw1My41LDE0MS4yLDM4LjQsMTQxLjItNzAuNmMwLTkwLjMtMzAuMS0xODYuMS02Ny4zLTIyNS45DQoJYy0zOC00MC43LTEwNS40LTI5LjMtMTM0LjQtMWMtMTEuMiwxMC45LTQwLjMsMTUuMS00MC4zLDE1LjFTMjIwLjksMTA5LjQsMjA5LjcsOTguNXogTTE2OS4zLDE2NS4xdjI5LjJoMjkuMg0KCWMxMS43LDAsMjEuMiw5LjEsMjEuMiwyMC4yYzAsMTEuMS05LjUsMjAuMi0yMS4yLDIwLjJoLTI5LjJ2MjkuMmMwLDExLjctOS4xLDIxLjItMjAuMiwyMS4yYy0xMS4xLDAtMjAuMi05LjUtMjAuMi0yMS4ydi0yOS4ySDk5LjgNCgljLTExLjcsMC0yMS4yLTkuMS0yMS4yLTIwLjJjMC0xMS4xLDkuNS0yMC4yLDIxLjItMjAuMkgxMjl2LTI5LjJjMC0xMS43LDkuMS0yMS4yLDIwLjItMjEuMkMxNjAuMywxNDMuOSwxNjkuMywxNTMuNCwxNjkuMywxNjUuMXoNCgkgTTM1MC44LDE3OS4yYzAtMTMuOSwxMS4zLTI1LjIsMjUuMi0yNS4yYzEzLjksMCwyNS4yLDExLjMsMjUuMiwyNS4yYzAsMTMuOS0xMS4zLDI1LjItMjUuMiwyNS4yDQoJQzM2Mi4xLDIwNC40LDM1MC44LDE5My4xLDM1MC44LDE3OS4yeiBNMzAwLjQsMjM5LjdjMC0xMy45LDExLjMtMjUuMiwyNS4yLTI1LjJjMTMuOSwwLDI1LjIsMTEuMywyNS4yLDI1LjINCgljMCwxMy45LTExLjMsMjUuMi0yNS4yLDI1LjJDMzExLjcsMjY0LjksMzAwLjQsMjUzLjYsMzAwLjQsMjM5Ljd6Ii8+DQo8L3N2Zz4NCg=="
          alt="Controller"
          width="18"
          height="18"
          loading="lazy"
          decoding="async"
        />
      </div>
    </div>
    <h2 class="about__subtitle">
      my name is <strong>cameron</strong>, i am a
      <strong>front end dev</strong> who likes...
    </h2>
    <div class="about__highlights">
      <div
        v-for="about in aboutData"
        :key="about.id"
        class="about__highlights-col"
      >
        <nuxt-img
          provider="cloudinary"
          :src="about.icon.img"
          :alt="about.icon.alt"
          :width="about.icon.width"
          :height="about.icon.height"
          :class="
            about.id !== 4
              ? 'about__highlights-col-img'
              : 'about__highlights-col-img about__highlights-col-img--rotate'
          "
          loading="lazy"
          decoding="async"
        />

        <h3 class="about__highlights-col-title">{{ about.title }}</h3>
        <p class="about__highlights-col-subtitle">{{ about.desc }}</p>
      </div>
    </div>

    <div class="about__divider"></div>

    <div class="about__title">
      <h1 class="about__title-text">
        &lt; i know cool codey (and non codey) things like /&gt;
      </h1>
      <div class="about__title-divider"></div>
      <div>
        <img
          src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNy4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMjQgMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsOiNBRjI3RjI7fQ0KPC9zdHlsZT4NCjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik01LjcsNmgxMi41Yy0wLjEtMC4yLTAuMi0wLjQtMC40LTAuNkwyMS4yLDJsLTEuNy0xLjdsLTMuNCwzLjRjLTAuMy0wLjItMC42LTAuNC0wLjktMC41Yy0yLTEuMS00LjUtMS4xLTYuNSwwDQoJQzguNCwzLjQsOC4xLDMuNSw3LjksMy43TDQuNCwwLjNMMi44LDJsMy40LDMuNEM2LDUuNiw1LjksNS44LDUuNyw2eiBNNC41LDguNEgwdjIuNGgyLjhjLTAuMSwwLjYtMC4xLDEuMi0wLjEsMS44DQoJYzAsMC42LDAuMSwxLjIsMC4xLDEuOEgwdjIuNGgzLjNjMCwwLDAsMC4xLDAsMC4xYzAuMiwwLjcsMC41LDEuMywwLjgsMS45QzQuMiwxOSw0LjMsMTksNC4zLDE5LjFsLTIuOCwyLjhsMS43LDEuN2wyLjUtMi41DQoJYzAuNywwLjgsMS41LDEuNCwyLjUsMS45YzAuNiwwLjMsMS4yLDAuNSwxLjgsMC43YzAuMiwwLjEsMC41LDAuMSwwLjcsMC4xdi03LjFoMi40djcuMWMwLjIsMCwwLjUtMC4xLDAuNy0wLjENCgljMC42LTAuMiwxLjItMC40LDEuOC0wLjdjMC42LTAuMywxLjEtMC43LDEuNi0xLjFjMC4zLTAuMywwLjYtMC42LDAuOS0wLjlsMi41LDIuNWwxLjctMS43bC0yLjgtMi44YzAuMS0wLjEsMC4xLTAuMiwwLjItMC4zDQoJYzAuMy0wLjYsMC42LTEuMywwLjgtMS45YzAsMCwwLTAuMSwwLTAuMUgyNHYtMi40aC0yLjhjMC4xLTAuNiwwLjEtMS4yLDAuMS0xLjhjMC0wLjYtMC4xLTEuMi0wLjEtMS44SDI0VjguNEg0LjV6Ii8+DQo8L3N2Zz4NCg=="
          alt="Bug"
          width="18"
          height="18"
          class="about__title-icon"
          loading="lazy"
          decoding="async"
        />
        <img
          src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNy4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDojQUYyN0YyO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjU2LDQuN0MxMTQuNiw0LjcsMCwxMjAsMCwyNjIuNGMwLDExMy44LDczLjMsMjEwLjQsMTc1LjEsMjQ0LjVjMTIuOCwyLjQsMTcuNS01LjYsMTcuNS0xMi40DQoJYzAtNi4xLTAuMi0yMi4zLTAuNC00My44QzEyMSw0NjYuMiwxMDYsNDE2LjEsMTA2LDQxNi4xYy0xMS42LTI5LjgtMjguNC0zNy43LTI4LjQtMzcuN2MtMjMuMy0xNiwxLjctMTUuNywxLjctMTUuNw0KCWMyNS43LDEuOCwzOS4yLDI2LjYsMzkuMiwyNi42YzIyLjgsMzkuNCw1OS45LDI4LDc0LjUsMjEuNGMyLjMtMTYuNyw4LjktMjgsMTYuMy0zNC41Yy01Ni44LTYuNS0xMTYuNi0yOC42LTExNi42LTEyNy40DQoJYzAtMjguMSwxMC01MS4xLDI2LjQtNjkuMmMtMi43LTYuNS0xMS40LTMyLjcsMi41LTY4LjJjMCwwLDIxLjUtNi45LDcwLjQsMjYuNGMyMC40LTUuNyw0Mi4zLTguNiw2NC4xLTguNw0KCWMyMS43LDAuMSw0My42LDIuOSw2NC4xLDguN2M0OC45LTMzLjMsNzAuMy0yNi40LDcwLjMtMjYuNGMxNCwzNS41LDUuMiw2MS43LDIuNiw2OC4yYzE2LjQsMTgsMjYuMyw0MSwyNi4zLDY5LjINCgljMCw5OS01OS44LDEyMC44LTExNi45LDEyNy4yYzkuMiw4LDE3LjQsMjMuNywxNy40LDQ3LjdjMCwzNC41LTAuMyw2Mi4yLTAuMyw3MC43YzAsNi45LDQuNiwxNC45LDE3LjYsMTIuNA0KCUM0MzguNyw0NzIuNyw1MTIsMzc2LjIsNTEyLDI2Mi40QzUxMiwxMjAsMzk3LjQsNC43LDI1Niw0LjdMMjU2LDQuN3oiLz4NCjwvc3ZnPg0K"
          alt="Github"
          width="18"
          height="18"
          class="about__title-icon about__title-icon--controller"
          loading="lazy"
          decoding="async"
        />
      </div>
    </div>
    <div class="about__skills">
      <p
        class="about__skills-item"
        v-for="(items, index) of skillsData.items"
        :key="index"
      >
        {{ items }}
      </p>
    </div>
  </section>
</template>
<script lang="ts" setup>
//* Import pinia store (global state)
import { useCoreStore } from "@/stores/coreStore";
import useInterObs from "~~/composables/useIntersectionObs";

// Init vars before everything else
let aboutData: any = ref();
let skillsData: any = ref();

// Ref the element
const about = ref(null);
// Assign const to global state
const coreStore = useCoreStore();

onMounted(() => {
  useInterObs(about, coreStore.setSection, 0.1);
});

async function initApi() {
  // About Data
  const rawAboutData = await $fetch("/api/query?col=about");

  // sort id descending order
  // @ts-ignore
  rawAboutData.sort(function (a: { id: number }, b: { id: number }) {
    return a.id - b.id;
  });

  // Assign to ref.value
  aboutData.value = rawAboutData;

  // ************************* //
  // Skills Data
  const rawSkillsData = await $fetch("/api/query?col=skills");

  // Filter to desired ID
  // @ts-ignore
  const filteredSkillsData = rawSkillsData.find(
    (item: { id: string }) => item.id === "bhGO42yK5Voe2pvPilS0"
  );

  skillsData.value = filteredSkillsData;
}

// TODO: ERR HANDLING
await initApi();
</script>
<style lang="sass" scoped>
.about
  max-width: 1400px
  width: 100%
  margin-left: auto
  margin-right: auto
  padding-left: 0.9rem
  padding-right: 0.9rem
  margin-bottom: calc(40vh + 4rem)
  @include edge-padding

  &__divider
    background-image: linear-gradient(#af27f2, #4003fe)
    width: 2px
    height: 350px
    margin: 2rem 0

  &__highlights
    display: flex
    flex-direction: row
    flex-wrap: nowrap

    @media (max-width: 768px)
      flex-direction: column

    &-col
      background-color: rgba(64, 52, 109, 0.6)
      height: auto
      text-align: center
      width: 25%
      padding: 3rem 0.75rem

      @media (max-width: 768px)
        width: 100%

      &:last-child
        background-image: linear-gradient(190deg, rgba(175, 39, 242, 0.6), rgba(64, 3, 254, 0.6))

      &-img
        margin-bottom: 0.5rem

        &--rotate
          -webkit-animation: rotateAnimation 1.5s linear 0s infinite normal none
          animation: rotateAnimation 1.5s linear 0s infinite normal none

      &-subtitle
        font-family: $main-font
        color: #d0d5f2
        // font-size: 1.1rem
        font-size: #{fluid(17.6px, 20px)}
        font-weight: 400

      &-title
        font-family: $main-font
        color: #d0d5f2
        // font-size: 2.2rem
        font-size: #{fluid(35.2px, 40px)}
        font-weight: 200
        margin-bottom: 0.5rem

  &__skills
    display: grid
    grid-template-columns: repeat(5, 1fr)
    grid-template-rows: repeat(2, 1fr)

    @media (max-width: 768px)
      grid-template-columns: repeat(2, 1fr)

    &-item
      font-family: $main-font
      color: #d0d5f2
      // font-size: 1.1rem
      font-size: #{fluid(17.6px, 20px)}
      text-align: center
      line-height: 120%
      margin: auto
      padding: 0 1rem
      background: $faded-purple
      width: 100%
      height: 135px
      display: flex
      align-items: center
      justify-content: center
      position: relative
      overflow: hidden
      z-index: 0

      @media (max-width: 768px)
        border: 1px solid $purple

      &:hover
        z-index: 0

        &::before
          opacity: 1
          transform: scale(1) translate(0, 0)
          border-radius: 1px

      &:before
        position: absolute
        content: ""
        top: 0
        right: 0
        bottom: 0
        left: 0
        background-image: linear-gradient(200deg, hsla(255, 99%, 50%, 1), hsla(282, 89%, 55%, 1))
        transform: scale(0) translate(300px, 50px)
        z-index: -1
        transition: 0.25s ease-in-out
        opacity: 0
        border-radius: 50%
        transform-origin: 100px 100px

      &:nth-child(1)
        border-top-left-radius: 10px

        &:before
          border-top-left-radius: 10px

      &:nth-child(2)
        @media (max-width: 768px)
          border-top-right-radius: 10px

        &:before
          @media (max-width: 768px)
            border-top-right-radius: 10px

      &:nth-child(5)
        border-top-right-radius: 10px

        @media (max-width: 768px)
          border-top-right-radius: 0px

        &:before
          border-top-right-radius: 10px

          @media (max-width: 768px)
            border-top-right-radius: 0px

      &:nth-child(6)
        border-bottom-left-radius: 10px

        @media (max-width: 768px)
          border-bottom-left-radius: 0px

        &:before
          border-bottom-left-radius: 10px

          @media (max-width: 768px)
            border-bottom-left-radius: 0px

      &:nth-child(9)
        @media (max-width: 768px)
          border-bottom-left-radius: 10px

        &:before
          @media (max-width: 768px)
            border-bottom-left-radius: 10px

      &:nth-child(10)
        border-bottom-right-radius: 10px

        &:before
          border-bottom-right-radius: 10px

  &__title
    display: flex
    flex-direction: row
    flex-wrap: wrap
    align-items: center
    // margin-bottom: 2.5rem
    margin-bottom: #{fluid(24px, 40px)}

    &-divider
      height: 1px
      width: 200px
      background: #af27f2
      margin: 5px 15px 0 10px

    &-icon
      margin-top: 5px
      margin-left: 2px
      margin-right: 2px

      &--controller
        margin-top: 0

    &-text
      font-family: $main-font
      // font-size: 2.2rem
      font-size: #{fluid(30px, 36px)}
      font-weight: 600
      background: -webkit-linear-gradient(left, #3700ff, #b629f2 45%)
      background-clip: text
      -webkit-background-clip: text
      -webkit-text-fill-color: transparent

  &__subtitle
    font-family: $main-font
    color: #d0d5f2
    // font-size: 1.3rem
    font-size: #{fluid(18px, 21px)}
    font-weight: 400
    // margin-bottom: 3rem
    margin-bottom: #{fluid(32px, 48px)}

@keyframes rotateAnimation
  0%
    transform: rotate(0)
  100%
    transform: rotate(360deg)
</style>
